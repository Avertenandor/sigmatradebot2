# –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-01-16  
**–°—Ç–∞—Ç—É—Å:** –ê–∫—Ç—É–∞–ª—å–Ω–æ  
**–í–µ—Ä—Å–∏—è:** 1.0

---

## –û–±–∑–æ—Ä

–î–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Ç—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –±–æ—Ç–∞ –∏ –∏—Ö –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏. –≠—Ç–∏ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –≤ E2E-—Ç–µ—Å—Ç–∞—Ö –∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞—â–∏—â–µ–Ω—ã –æ—Ç —Ä–µ–≥—Ä–µ—Å—Å–∏–π.

---

## 1. –ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è –∞–¥–º–∏–Ω–∞

### –û–ø–∏—Å–∞–Ω–∏–µ —É–≥—Ä–æ–∑—ã

**–°—Ü–µ–Ω–∞—Ä–∏–π:** –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –±–æ—Ç–∞ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω (—É—Ç–µ—á–∫–∞ —É—á—ë—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –≤–∑–ª–æ–º –∞–∫–∫–∞—É–Ω—Ç–∞, –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —É–≥—Ä–æ–∑–∞).

**–†–∏—Å–∫–∏:**
- –ù–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å–∏—Å—Ç–µ–º—ã
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –î–æ—Å—Ç—É–ø –∫ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–º –æ–ø–µ—Ä–∞—Ü–∏—è–º

### –®–∞–≥–∏ –ø–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ

1. **Super admin** –ø–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏
2. –í—ã–ø–æ–ª–Ω—è–µ—Ç **—ç–∫—Å—Ç—Ä–µ–Ω–Ω—É—é –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –∞–¥–º–∏–Ω–∞** —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å:
   - –í—ã–±–∏—Ä–∞–µ—Ç "üõë –≠–∫—Å—Ç—Ä–µ–Ω–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∞–¥–º–∏–Ω–∞"
   - –í–≤–æ–¥–∏—Ç Telegram ID —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∞–¥–º–∏–Ω–∞
3. –°–∏—Å—Ç–µ–º–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∞—Ç–æ–º–∞—Ä–Ω—É—é –æ–ø–µ—Ä–∞—Ü–∏—é:
   - –°–æ–∑–¥–∞—ë—Ç –∑–∞–ø–∏—Å—å –≤ `blacklist` —Å `action_type=TERMINATED`
   - –£–¥–∞–ª—è–µ—Ç –∞–¥–º–∏–Ω–∞ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `admins`
   - –ï—Å–ª–∏ –µ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —ç—Ç–∏–º `telegram_id` ‚Üí —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `user.is_banned=True`
   - –õ–æ–≥–∏—Ä—É–µ—Ç —Å–æ–±—ã—Ç–∏–µ `[SECURITY] Admin terminated`

### –†–µ–∑—É–ª—å—Ç–∞—Ç

- ‚úÖ –ê–¥–º–∏–Ω **–ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª—ë–Ω** –∏–∑ —Å–∏—Å—Ç–µ–º—ã (–Ω–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ `admins`)
- ‚úÖ –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç —ç—Ç–æ–≥–æ `telegram_id` –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è `BanMiddleware` (TERMINATED)
- ‚úÖ –ê–¥–º–∏–Ω **–Ω–µ –º–æ–∂–µ—Ç –≤–æ–π—Ç–∏** –≤ —Å–∏—Å—Ç–µ–º—É (–Ω–µ—Ç –∑–∞–ø–∏—Å–∏ –≤ `admins`)
- ‚úÖ –ï—Å–ª–∏ –∞–¥–º–∏–Ω –±—ã–ª —Ç–∞–∫–∂–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º ‚Üí `user.is_banned=True`

### –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏

**–§–∞–π–ª:** `tests/e2e/security/test_admin_compromise_flow.py`

**–¢–µ—Å—Ç—ã:**
1. `test_emergency_admin_block_complete_flow()` - –ø–æ–ª–Ω—ã–π —Ñ–ª–æ—É –æ—Ç —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
2. `test_blocked_admin_cannot_login()` - –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–¥–º–∏–Ω –Ω–µ –º–æ–∂–µ—Ç –≤–æ–π—Ç–∏
3. `test_blocked_admin_middleware_blocks_updates()` - BanMiddleware —Ä–µ–∂–µ—Ç –∞–ø–¥–µ–π—Ç—ã
4. `test_blocked_admin_with_user_account()` - –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∞–¥–º–∏–Ω–∞, –∫–æ—Ç–æ—Ä—ã–π —Ç–∞–∫–∂–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

**–°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã:**
- `tests/security/test_emergency_admin_block.py` - unit-—Ç–µ—Å—Ç—ã –∞—Ç–æ–º–∞—Ä–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

---

## 2. DDoS –∞—Ç–∞–∫–∞

### –û–ø–∏—Å–∞–Ω–∏–µ —É–≥—Ä–æ–∑—ã

**–°—Ü–µ–Ω–∞—Ä–∏–π:** –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –ø—ã—Ç–∞–µ—Ç—Å—è –ø–µ—Ä–µ–≥—Ä—É–∑–∏—Ç—å –±–æ—Ç–∞ –º–∞—Å—Å–æ–≤—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏ –∏–ª–∏ —Å–ø–∞–º–æ–º.

**–í–∏–¥—ã –∞—Ç–∞–∫:**
1. **Spam-–∞—Ç–∞–∫–∞:** >30 —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –º–∏–Ω—É—Ç—É –æ—Ç –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. **Registration flood:** >3 –ø–æ–ø—ã—Ç–∫–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤ —á–∞—Å
3. **Verification flood:** >5 –ø–æ–ø—ã—Ç–æ–∫ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ —á–∞—Å
4. **Withdrawal flood:** >10 –∑–∞—è–≤–æ–∫ –Ω–∞ –≤—ã–≤–æ–¥ –≤ –¥–µ–Ω—å –ò–õ–ò >3 –≤ —á–∞—Å

**–†–∏—Å–∫–∏:**
- –ü–µ—Ä–µ–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
- –ò—Å—á–µ—Ä–ø–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ (Redis, –ë–î)
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ª–µ–≥–∏—Ç–∏–º–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ—Ç–µ—Ä–∏ (–µ—Å–ª–∏ –≤—ã–≤–æ–¥—ã –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã)

### –ó–∞—â–∏—Ç–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã

#### 1. RateLimitMiddleware (Redis)

**–õ–∏–º–∏—Ç:** 30 –∞–ø–¥–µ–π—Ç–æ–≤ –≤ –º–∏–Ω—É—Ç—É –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–î–µ–π—Å—Ç–≤–∏–µ:** –ï—Å–ª–∏ –ª–∏–º–∏—Ç –ø—Ä–µ–≤—ã—à–µ–Ω ‚Üí –∑–∞–ø—Ä–æ—Å –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è, —Ö—ç–Ω–¥–ª–µ—Ä –ù–ï –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** `bot/middlewares/rate_limit_middleware.py`

#### 2. OperationRateLimiter (Redis)

**–õ–∏–º–∏—Ç—ã:**
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: 3 –ø–æ–ø—ã—Ç–∫–∏ / —á–∞—Å
- –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è: 5 –ø–æ–ø—ã—Ç–æ–∫ / —á–∞—Å
- –í—ã–≤–æ–¥: 10 –∑–∞—è–≤–æ–∫ / –¥–µ–Ω—å –ò–õ–ò 3 –∑–∞—è–≤–∫–∏ / —á–∞—Å

**–î–µ–π—Å—Ç–≤–∏–µ:** –ï—Å–ª–∏ –ª–∏–º–∏—Ç –ø—Ä–µ–≤—ã—à–µ–Ω ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞ —Å –ø–æ–Ω—è—Ç–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** `bot/utils/operation_rate_limit.py`

#### 3. Fail-open —Å—Ç—Ä–∞—Ç–µ–≥–∏—è

**–ü—Ä–∞–≤–∏–ª–æ:** –ï—Å–ª–∏ Redis –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Üí –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω—ã (fail-open)

**–ü—Ä–∏—á–∏–Ω–∞:** –õ—É—á—à–µ —Ä–∞–∑—Ä–µ—à–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é, —á–µ–º –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—Ä–∏ —Å–±–æ–µ Redis

### –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏

**–§–∞–π–ª:** `tests/e2e/security/test_ddos_flows.py`

**–¢–µ—Å—Ç—ã:**
1. `test_rate_limit_middleware_blocks_spam()` - –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ >30 –∞–ø–¥–µ–π—Ç–æ–≤/–º–∏–Ω—É—Ç—É
2. `test_registration_rate_limit()` - –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ >3 —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π/—á–∞—Å
3. `test_verification_rate_limit()` - –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ >5 –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–π/—á–∞—Å
4. `test_withdrawal_rate_limits()` - –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ >10 –≤—ã–≤–æ–¥–æ–≤/–¥–µ–Ω—å –∏–ª–∏ >3/—á–∞—Å
5. `test_rate_limiter_allows_within_limits()` - –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –ª–∏–º–∏—Ç–æ–≤ —Ä–∞–∑—Ä–µ—à–µ–Ω—ã
6. `test_rate_limiter_fail_open_on_redis_unavailable()` - fail-open –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Redis
7. `test_combined_ddos_scenario()` - –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∞—Ç–∞–∫–∞ (spam + –æ–ø–µ—Ä–∞—Ü–∏–∏)

**–°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã:**
- `tests/security/test_ddos_scenario.py` - –±–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã DDoS-–∑–∞—â–∏—Ç—ã
- `tests/security/test_rate_limit_middleware.py` - —Ç–µ—Å—Ç—ã RateLimitMiddleware

---

## 3. –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –û–ø–∏—Å–∞–Ω–∏–µ —É–≥—Ä–æ–∑—ã

**–°—Ü–µ–Ω–∞—Ä–∏–π:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—Ä—É—à–∞–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ (—Å–ø–∞–º, –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ, –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å).

**–¢–∏–ø—ã –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫:**
1. **BLOCKED** - –≤—Ä–µ–º–µ–Ω–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –∞–ø–µ–ª–ª—è—Ü–∏–∏
2. **TERMINATED** - –ø–æ–ª–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –±–µ–∑ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∞–ø–µ–ª–ª—è—Ü–∏–∏

### BLOCKED vs TERMINATED

#### BLOCKED (action_type=BLOCKED)

**–ß—Ç–æ –º–æ–∂–µ—Ç:**
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∏—Ç—å `/start` (–≤–∏–¥–∏—Ç –º–µ–Ω—é —Å –∫–Ω–æ–ø–∫–æ–π –∞–ø–µ–ª–ª—è—Ü–∏–∏)
- ‚úÖ –ù–∞–∂–∞—Ç—å "üìù –ü–æ–¥–∞—Ç—å –∞–ø–µ–ª–ª—è—Ü–∏—é"
- ‚úÖ –ü–æ–¥–∞—Ç—å –∞–ø–µ–ª–ª—è—Ü–∏—é (–≤ —Ç–µ—á–µ–Ω–∏–µ 3 —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π)

**–ß—Ç–æ –ù–ï –º–æ–∂–µ—Ç:**
- ‚ùå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–µ–ø–æ–∑–∏—Ç—ã, –≤—ã–≤–æ–¥—ã, —Ä–µ—Ñ–µ—Ä–∞–ª—ã
- ‚ùå –î–æ—Å—Ç—É–ø –∫ –æ—Å–Ω–æ–≤–Ω–æ–º—É —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—É –±–æ—Ç–∞

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `BanMiddleware` –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç —Ç–æ–ª—å–∫–æ `/start` –∏ –∞–ø–µ–ª–ª—è—Ü–∏—é
- `main_menu_reply_keyboard()` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¢–û–õ–¨–ö–û –∫–Ω–æ–ø–∫—É "üìù –ü–æ–¥–∞—Ç—å –∞–ø–µ–ª–ª—è—Ü–∏—é"

#### TERMINATED (action_type=TERMINATED)

**–ß—Ç–æ –º–æ–∂–µ—Ç:**
- ‚ùå **–ù–ò–ß–ï–ì–û** - –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω

**–ß—Ç–æ –ù–ï –º–æ–∂–µ—Ç:**
- ‚ùå –û—Ç–ø—Ä–∞–≤–∏—Ç—å –õ–Æ–ë–û–ï —Å–æ–æ–±—â–µ–Ω–∏–µ
- ‚ùå –í–∏–¥–µ—Ç—å –º–µ–Ω—é
- ‚ùå –ü–æ–¥–∞—Ç—å –∞–ø–µ–ª–ª—è—Ü–∏—é

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `BanMiddleware` –±–ª–æ–∫–∏—Ä—É–µ—Ç –í–°–ï –∞–ø–¥–µ–π—Ç—ã –î–û —Ö—ç–Ω–¥–ª–µ—Ä–æ–≤ (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `None`)
- –í –ª–æ–≥ –ø–∏—à–µ—Ç—Å—è: `[SECURITY] Terminated user attempted to use bot`

### –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏

**–§–∞–π–ª:** `tests/e2e/security/test_blocklist_roles_flow.py`

**–¢–µ—Å—Ç—ã:**
1. `test_blocked_user_sees_appeal_button_only()` - BLOCKED –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ –∞–ø–µ–ª–ª—è—Ü–∏—é
2. `test_blocked_user_can_access_start_and_appeal()` - BLOCKED –º–æ–∂–µ—Ç /start –∏ –∞–ø–µ–ª–ª—è—Ü–∏—é
3. `test_terminated_user_all_updates_blocked()` - TERMINATED –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
4. `test_terminated_user_no_menu()` - TERMINATED –Ω–µ –≤–∏–¥–∏—Ç –º–µ–Ω—é
5. `test_inactive_blacklist_does_not_block()` - –Ω–µ–∞–∫—Ç–∏–≤–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç

**–°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã:**
- `tests/security/test_ban_middleware.py` - —Ç–µ—Å—Ç—ã BanMiddleware
- `tests/integration/test_withdrawal_roles.py` - —Ç–µ—Å—Ç—ã —Ä–æ–ª–µ–π –ø—Ä–∏ –≤—ã–≤–æ–¥–µ

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∫—Ä—ã—Ç–∏—è

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤

```bash
# –í—Å–µ security E2E-—Ç–µ—Å—Ç—ã
pytest tests/e2e/security/ -v -m "security"

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
pytest tests/e2e/security/test_admin_compromise_flow.py -v
pytest tests/e2e/security/test_ddos_flows.py -v
pytest tests/e2e/security/test_blocklist_roles_flow.py -v

# –í—Å–µ security-—Ç–µ—Å—Ç—ã (unit + e2e)
pytest tests/security/ tests/e2e/security/ -v -m "security"
```

### –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ —Ä–µ–ª–∏–∑–æ–º

- [ ] –í—Å–µ E2E security-—Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] –ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è –∞–¥–º–∏–Ω–∞: —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] DDoS-–∑–∞—â–∏—Ç–∞: —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏: —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] –õ–æ–≥–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç `[SECURITY]` —Å–æ–±—ã—Ç–∏—è
- [ ] Redis fail-open —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- `docs/audit/ROLES_MENU_MATRIX.md` - –º–∞—Ç—Ä–∏—Ü–∞ —Ä–æ–ª–µ–π –∏ –∫–Ω–æ–ø–æ–∫
- `docs/audit/KEYBOARD_USAGE_AUDIT.md` - –∞—É–¥–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä
- `bot/middlewares/ban_middleware.py` - —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è BanMiddleware
- `bot/middlewares/rate_limit_middleware.py` - —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è RateLimitMiddleware
- `bot/utils/operation_rate_limit.py` - —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è OperationRateLimiter

---

**–ü–æ—Å–ª–µ–¥–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞:** 2025-01-16  
**–°–ª–µ–¥—É—é—â–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:** –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ª–æ–≥–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

