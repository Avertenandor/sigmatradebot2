# –ß–µ–∫–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É

–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏: 2025-01-XX

## ‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–í–ï–†–ö–ò

### 1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- [x] `DEBUG=false` –≤ production (–≤–∞–ª–∏–¥–∞—Ü–∏—è –≤ settings.py)
- [x] `ENVIRONMENT=production` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [x] –í—Å–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏ –¥–ª–∏–Ω–æ–π >= 32 —Å–∏–º–≤–æ–ª–æ–≤
- [x] –ù–µ—Ç placeholder –∑–Ω–∞—á–µ–Ω–∏–π –≤ .env
- [x] –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç (validate-env.py)
- [x] docker-entrypoint.sh –∑–∞–ø—É—Å–∫–∞–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—é –ø–µ—Ä–µ–¥ —Å—Ç–∞—Ä—Ç–æ–º

### 2. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- [x] –ú–∏–≥—Ä–∞—Ü–∏–∏ Alembic –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [x] –ü–æ—Ä—è–¥–æ–∫ –º–∏–≥—Ä–∞—Ü–∏–π –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π (–Ω–µ—Ç –≤–µ—Ç–≤–ª–µ–Ω–∏–π)
- [x] –ò–Ω–¥–µ–∫—Å—ã –Ω–∞ –∫–ª—é—á–µ–≤—ã—Ö –ø–æ–ª—è—Ö
- [x] –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—É–ª–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã (pool_size=5, max_overflow=10)
- [x] pool_pre_ping=True –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- [x] pool_recycle=300 –¥–ª—è –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

### 3. –ë–ª–æ–∫—á–µ–π–Ω
- [x] Chain ID –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ RPC (mainnet = 56)
- [x] –ù–µ—Ç hardcoded –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è testnet
- [x] –í–∞–ª–∏–¥–∞—Ü–∏—è –∞–¥—Ä–µ—Å–æ–≤ –∫–æ—à–µ–ª—å–∫–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ blockchain_service
- [x] Retry –ª–æ–≥–∏–∫–∞ –¥–ª—è –ø–ª–∞—Ç–µ–∂–µ–π (exponential backoff)

### 4. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- [x] –í–∞–ª–∏–¥–∞—Ü–∏—è –∞–¥—Ä–µ—Å–æ–≤ –∫–æ—à–µ–ª—å–∫–æ–≤ (0x + 42 —Å–∏–º–≤–æ–ª–∞)
- [x] –í–∞–ª–∏–¥–∞—Ü–∏—è tx_hash (0x + 66 —Å–∏–º–≤–æ–ª–æ–≤)
- [x] –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –ø–∞—Ä–æ–ª—è (–º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤)
- [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –∫–æ—à–µ–ª—å–∫–æ–≤
- [x] –ì–ª–æ–±–∞–ª—å–Ω—ã–π error_handler –≤ main.py
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤–æ –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö

### 5. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ë–î
- [x] session_factory –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö (deposit, withdrawal)
- [x] –ö–æ—Ä–æ—Ç–∫–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è –¥–æ FSM state changes)
- [x] Fallback –Ω–∞ —Å—Ç–∞—Ä—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

### 6. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- [x] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ (loguru —Å —Ä–æ—Ç–∞—Ü–∏–µ–π)
- [x] LoggerMiddleware –ª–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- [x] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–æ–±—ã—Ç–∏–π (–¥–µ–ø–æ–∑–∏—Ç—ã, –≤—ã–≤–æ–¥—ã, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è)
- [x] –°–∫—Ä–∏–ø—Ç—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –Ω–∞ –º–µ—Å—Ç–µ (monitor_db.py, health-check.sh)
- [x] notify_admin.py –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∞–¥–º–∏–Ω–æ–≤

### 7. –§–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏
- [x] deposit_monitoring - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–µ–ø–æ–∑–∏—Ç–æ–≤ (–∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É)
- [x] daily_rewards - –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è (—Ä–∞–∑ –≤ –¥–µ–Ω—å)
- [x] payment_retry - –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π (–∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É)
- [x] notification_retry - –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É)
- [x] –í—Å–µ –∑–∞–¥–∞—á–∏ –∏–º–µ—é—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫

### 8. Docker –∏ –¥–µ–ø–ª–æ–π
- [x] docker-compose.python.yml –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- [x] docker-entrypoint.sh –∑–∞–ø—É—Å–∫–∞–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏
- [x] Health checks –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –¥–ª—è postgres –∏ redis
- [x] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ

### 9. –¢–µ—Å—Ç—ã –∏ –ª–∏–Ω—Ç–∏–Ω–≥
- [x] –¢–µ—Å—Ç—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã (pytest)
- [x] –õ–∏–Ω—Ç–∏–Ω–≥ –Ω–∞—Å—Ç—Ä–æ–µ–Ω (ruff)
- [x] –¢–µ—Å—Ç—ã –¥–ª—è –º–æ–¥–µ–ª–µ–π, —Å–µ—Ä–≤–∏—Å–æ–≤, –≤–∞–ª–∏–¥–∞—Ü–∏–∏

### 10. –•–µ–Ω–¥–ª–µ—Ä—ã –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏—è
- [x] –í—Å–µ –≤–∞–∂–Ω—ã–µ callback_data –∏–º–µ—é—Ç —Ö–µ–Ω–¥–ª–µ—Ä—ã
- [x] –£–¥–∞–ª–µ–Ω –º–µ—Ä—Ç–≤—ã–π –∫–æ–¥
- [x] –î—É–±–ª–∏—Ä—É—é—â–∏–µ —Ö–µ–Ω–¥–ª–µ—Ä—ã —É–¥–∞–ª–µ–Ω—ã
- [x] –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —Ö–µ–Ω–¥–ª–µ—Ä—ã (main_menu, admin_support)

## ‚ö†Ô∏è –ù–ï–ö–†–ò–¢–ò–ß–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### 1. –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ callback_data
- **–ü—Ä–æ–±–ª–µ–º–∞**: inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è (–±–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç reply)
- **–°—Ç–∞—Ç—É—Å**: –ù–µ–∫—Ä–∏—Ç–∏—á–Ω–æ, –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ

### 2. DatabaseMiddleware
- **–ü—Ä–æ–±–ª–µ–º–∞**: –î–µ—Ä–∂–∏—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –Ω–∞ –≤–µ—Å—å handler
- **–°—Ç–∞—Ç—É—Å**: TODO –æ—Å—Ç–∞–≤–ª–µ–Ω –¥–ª—è –±—É–¥—É—â–µ–π –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ session_factory
- **–í–ª–∏—è–Ω–∏–µ**: –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ, –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç session_factory

### 3. –î–≤–∞ BlockchainService
- **–ü—Ä–æ–±–ª–µ–º–∞**: –°—Ç–∞—Ä—ã–π –∏ –Ω–æ–≤—ã–π BlockchainService
- **–°—Ç–∞—Ç—É—Å**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞—Ä—ã–π, —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- **–í–ª–∏—è–Ω–∏–µ**: –ù–µ—Ç, –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –¥–ª—è –±—É–¥—É—â–µ–π –º–∏–≥—Ä–∞—Ü–∏–∏

### 4. finpass_recovery
- **–ü—Ä–æ–±–ª–µ–º–∞**: –í—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω –∏–∑-–∑–∞ –ø—Ä–æ–±–ª–µ–º —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π
- **–°—Ç–∞—Ç—É—Å**: –ù–µ–∫—Ä–∏—Ç–∏—á–Ω–æ, –º–æ–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å

## üìã –ü–ï–†–ï–î –î–ï–ü–õ–û–ï–ú

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —à–∞–≥–∏:
1. ‚úÖ –ó–∞–ø–æ–ª–Ω–∏—Ç—å .env —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é: `python scripts/validate-env.py`
3. ‚úÖ –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ RPC_URL —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ mainnet BSC
4. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ –∞–¥—Ä–µ—Å–∞ –∫–æ—à–µ–ª—å–∫–æ–≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ
5. ‚úÖ –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ DEBUG=false –∏ ENVIRONMENT=production
6. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏: `alembic current` –∏ `alembic heads`
7. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç—å health-check: `./scripts/health-check.sh`

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —à–∞–≥–∏:
1. –°–æ–∑–¥–∞—Ç—å backup –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ staging –æ–∫—Ä—É–∂–µ–Ω–∏–∏
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è
4. –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ø–µ—Ä–≤—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

## ‚úÖ –ò–¢–û–ì–û–í–´–ô –°–¢–ê–¢–£–°

**–ë–û–¢ –ì–û–¢–û–í –ö –ü–†–û–î–ê–ö–®–ï–ù–£!** üéâ

–í—Å–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç:
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≥–æ—Ç–æ–≤–∞
- ‚úÖ –ë–ª–æ–∫—á–µ–π–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ mainnet
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞ –º–µ—Å—Ç–µ
- ‚úÖ –§–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- ‚úÖ Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:
1. –ó–∞–ø–æ–ª–Ω–∏—Ç—å .env —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
3. –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ø–µ—Ä–≤—ã–µ —á–∞—Å—ã —Ä–∞–±–æ—Ç—ã
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –∏ –º–µ—Ç—Ä–∏–∫–∏

